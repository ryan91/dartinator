<!doctype html>
<html>

<head>
  <title>Dartinator - GAME ON!!!</title>
</head>
<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script type="text/javascript">
  "use strict";
  var dart_count = 0;
  var dart_fields = [];
  $(document).ready(function () {
    document.querySelectorAll('path[data-value]').forEach((el) =>
      el.onclick = (evt) => on_field_selected(evt));
    document.querySelectorAll('circle[data-radius]').forEach((el) =>
      el.onclick = (evt) => on_field_selected(evt));
  });
  function on_field_selected(evt) {
    const r = Number(evt.target.dataset.radius);
    const v = Number(evt.target.dataset.value);
    dart_count = dart_count + 1;
    //let field_str = '';
    if (dart_count <= 3) {
      let field_id = Number(evt.target.id);
      dart_fields.push({ radius : r, value : v });
    }
    if (dart_count == 3) {
      console.log(dart_fields);
      const request = new XMLHttpRequest();
      request.open('POST', '/running-game');
      request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
      request.send(JSON.stringify(dart_fields));
      dart_count = 0;
      dart_fields.length = 0;
    }
  }
</script>

<body>{{board}}
</body>

</html>
